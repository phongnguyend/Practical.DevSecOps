                 
az group create --name "PracticalPrivateEndpoints" --location "southeastasia"

az sql server create --resource-group "PracticalPrivateEndpoints" \
                     --name "PracticalPrivateEndpoints" \
                     --location "southeastasia" \
                     --admin-user "PracticalPrivateEndpoints" \
                     --admin-password 'sqladmin123!@#'

az sql server firewall-rule create --resource-group "PracticalPrivateEndpoints" \
                                   --server "PracticalPrivateEndpoints" \
                                   --name "Allow Azure services and resources to access this server" \
                                   --start-ip-address 0.0.0.0 \
                                   --end-ip-address 0.0.0.0

az sql db create --resource-group "PracticalPrivateEndpoints" \
                 --name "PracticalPrivateEndpoints-DEV" \
                 --server "PracticalPrivateEndpoints" \
                 --service-objective Basic \
                 --backup-storage-redundancy Local

az sql db create --resource-group "PracticalPrivateEndpoints" \
                 --name "PracticalPrivateEndpoints-QC" \
                 --server "PracticalPrivateEndpoints" \
                 --service-objective Basic \
                 --backup-storage-redundancy Local

az appservice plan create --resource-group "PracticalPrivateEndpoints" \
                          --name PracticalPrivateEndpoints \
                          --location "southeastasia" \
                          --sku D1 \

az webapp create --resource-group "PracticalPrivateEndpoints" \
                 --plan PracticalPrivateEndpoints \
                 --name PracticalPrivateEndpoints-DEV \
                 --runtime "DOTNET:8"

az webapp create --resource-group "PracticalPrivateEndpoints" \
                 --plan PracticalPrivateEndpoints \
                 --name PracticalPrivateEndpoints-DEV-API \
                 --runtime "DOTNET:8"
				 
az webapp create --resource-group "PracticalPrivateEndpoints" \
                 --plan PracticalPrivateEndpoints \
                 --name PracticalPrivateEndpoints-QC \
                 --runtime "DOTNET:8"

az webapp create --resource-group "PracticalPrivateEndpoints" \
                 --plan PracticalPrivateEndpoints \
                 --name PracticalPrivateEndpoints-QC-API \
                 --runtime "DOTNET:8"


connectionString=$(az sql db show-connection-string -s PracticalPrivateEndpoints -n PracticalPrivateEndpoints-DEV -c ado.net --out tsv)
connectionString=${connectionString/<username>/PracticalPrivateEndpoints}
connectionString=${connectionString/<password>/'sqladmin123!@#'}
echo $connectionString

az webapp config appsettings set \
  --resource-group PracticalPrivateEndpoints \
  --name PracticalPrivateEndpoints-DEV-API \
  --settings "ConnectionStrings__DefaultConnection=$connectionString"
  
connectionString=$(az sql db show-connection-string -s PracticalPrivateEndpoints -n PracticalPrivateEndpoints-QC -c ado.net --out tsv)
connectionString=${connectionString/<username>/PracticalPrivateEndpoints}
connectionString=${connectionString/<password>/'sqladmin123!@#'}
echo $connectionString

az webapp config appsettings set \
  --resource-group PracticalPrivateEndpoints \
  --name PracticalPrivateEndpoints-QC-API \
  --settings "ConnectionStrings__DefaultConnection=$connectionString"
